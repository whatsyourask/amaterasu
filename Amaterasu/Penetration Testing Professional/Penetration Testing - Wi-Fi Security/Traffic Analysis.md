[[Wi-Fi Pentest]]
# Monitor mode
- Promiscuous mode is called monitor mode in 802.11 jargon.
- Put your interface into monitor mode with airmon-ng:
	- `airmon-ng start <interface>`
	- command will create a new virtual Wi-Fi interface. The new name will be mon0.
# Channel hopping
Constantly switching between the channels.
While locked to a specific channel, the wireless adapter still can not receive frames sent on any others channel.
- airodump-ng supports channel hopping.
- `airodump-ng -w outfile interface`
- if you have a supported card, you could also hop on more than one wireless band using the --band option and specifying a combination of a, b and g letters.
# Wireless filters
- about every 100ms beacon frames are sent.
- `wlan.fc.type_subtype != 0x08` - match frames that is not a beacon frames.
- `wlan.fc.type == 0x02` - get only Data frames.
- ![[Снимок экрана 2023-09-23 в 17.28.26.png]]
# Traffic Decryption
- 'Edit - Preferences' and select IEEE 802.11.
- Enable decryption
- Decryption keys - Edit
- New
- Enter protocol WEP or WPA and then enter key in hexadecimal format.
- For WPA: wpa-pwd select and then password:SSID format.
- WPA uses a per-session key generated by two communicating so you have to collect 4-way handshake between those two stations. To ensure you captured the handshake, apply a filter using 'eapol'.
- We can see only low level protocol information.
## Airdecap-ng 
Tool for decryption WEP, WPA or WPA2 encrypted packets.
- `airdecap-ng -w <wep_key_in_hex> <.cap>`
- report:![[Снимок экрана 2023-09-23 в 17.45.28.png]]
- `airdecap-ng -p <wpa_passphrase> -e <SSID> <.cap>` - also need to specify SSID.
- airdecap-ng removes all 802.11 header from the decrypted frames - it can be annoying. To disable this behavior use flag -l.